<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';">
    <title>WeChat Bot Client</title>
    <link rel="stylesheet" href="./styles/index.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>WeChat Bot 客户端</h1>
        </header>

        <div class="tabs">
            <button class="tab-btn active" data-tab="setup">
                <span class="tab-icon">⚙️</span> 基础设置
            </button>
            <button class="tab-btn" data-tab="whitelist">
                <span class="tab-icon">📋</span> 白名单配置
            </button>
            <button class="tab-btn" data-tab="schedule">
                <span class="tab-icon">⏰</span> 定时任务
            </button>
            <button class="tab-btn" data-tab="logs">
                <span class="tab-icon">📝</span> 日志记录
            </button>
        </div>

        <div class="tab-content active" id="setup">
            <div class="form-group">
                <label>AITIWO API Key:</label>
                <input type="text" id="aitiwoKey" placeholder="请输入 AITIWO API Key">
                <div class="form-help">在 AITIWO 平台获取 API Key</div>
                <div class="api-status"></div>
            </div>
            <div class="bot-control">
                <button id="startBot" class="btn-primary">启动机器人</button>
                <div class="bot-status-box">
                    <div class="status-icon"></div>
                    <div class="status-message">等待启动...</div>
                    <div class="connection-status"></div>
                </div>
            </div>
            <div class="qrcode-container" id="qrcode">
                <div class="qrcode-loading">
                    <div class="spinner"></div>
                    <p>正在生成二维码...</p>
                </div>
                <div class="qrcode-status"></div>
                <div class="qrcode-timeout">
                    <p>二维码已过期</p>
                    <button class="btn-primary refresh-qrcode">刷新二维码</button>
                </div>
            </div>
            <div class="key-messages">
                <h3>运行状态</h3>
                <div class="message-list" id="keyMessages"></div>
            </div>
        </div>

        <div class="tab-content" id="whitelist">
            <div class="form-group">
                <label>联系人白名单:</label>
                <textarea id="contactWhitelist" placeholder="每行输入一个联系人"></textarea>
                <div class="form-help">仅允许白名单中的联系人使用机器人</div>
            </div>
            <div class="form-group">
                <label>群聊白名单:</label>
                <textarea id="roomWhitelist" placeholder="每行输入一个群名"></textarea>
                <div class="form-help">仅在白名单中的群聊响应消息</div>
            </div>
            <div class="whitelist-controls">
                <button id="saveWhitelist" class="btn-primary">保存配置</button>
                <button id="importWhitelist" class="btn-secondary">导入白名单</button>
                <button id="exportWhitelist" class="btn-secondary">导出白名单</button>
            </div>
        </div>

        <div class="tab-content" id="schedule">
            <div class="schedule-form">
                <h3>添加定时任务</h3>
                <div class="form-group">
                    <label>群名称:</label>
                    <input type="text" id="scheduleRoom" placeholder="输入群名称">
                </div>
                <div class="form-group">
                    <label>消息内容:</label>
                    <textarea id="scheduleMessage" placeholder="输入要发送的消息"></textarea>
                </div>
                <div class="form-group">
                    <label>定时规则 (Cron):</label>
                    <input type="text" id="scheduleCron" placeholder="例如: 0 0 8 * * *">
                    <div class="cron-helper">
                        <p>常用示例:</p>
                        <ul>
                            <li>🕐 每天早8点: 0 0 8 * * *</li>
                            <li>📅 每周一早8点: 0 0 8 * * 1</li>
                            <li>📆 每月1号早8点: 0 0 8 1 * *</li>
                        </ul>
                    </div>
                </div>
                <button id="addSchedule" class="btn-success">添加定时任务</button>
            </div>
            <div class="schedule-list">
                <h3>任务列表</h3>
                <div id="scheduleItems"></div>
            </div>
        </div>

        <div class="tab-content" id="logs">
            <div class="logs-header">
                <h3>系统日志</h3>
                <div class="logs-controls">
                    <select id="logLevel" class="log-filter">
                        <option value="all">所有级别</option>
                        <option value="info">信息</option>
                        <option value="warn">警告</option>
                        <option value="error">错误</option>
                        <option value="debug">调试</option>
                    </select>
                    <input type="text" id="logSearch" class="log-search" placeholder="搜索日志...">
                    <div class="log-actions">
                        <button id="clearLogs" class="btn-warning">清除日志</button>
                        <button id="exportLogs" class="btn-primary">导出日志</button>
                    </div>
                </div>
            </div>
            <div class="logs-container" id="logsContainer">
                <div class="log-list"></div>
            </div>
            <div class="logs-footer">
                <div class="log-stats">
                    <span class="total-logs">总日志数: <span id="totalLogs">0</span></span>
                    <span class="filtered-logs">已过滤: <span id="filteredLogs">0</span></span>
                </div>
            </div>
            <div id="logViewer"></div>
        </div>
    </div>
    <div id="logViewer"></div>
    <script src="./js/error-handler.js"></script>
    <script type="module" src="./renderer.bundle.js"></script>
</body>
</html> 